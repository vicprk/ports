# Description: A middleware layer between C libraries (using GObject) and language bindings.
# URL: https://live.gnome.org/GObjectIntrospection
# Maintainer: Danny Rawlins, crux at romster dot me
# Depends on: glib-32 python-32

name=gobject-introspection-compat32
aname=gobject-introspection
version=1.66.1
release=1
source=(https://ftp.gnome.org/pub/GNOME/sources/$aname/${version::4}/$aname-$version.tar.xz
		use_python_header.diff
		meson_python_header.diff
		gobject-introspection-1.58.3-64bit-multilib.patch
		crossfile.ini)

build() {

#	export PKG_CONFIG_PATH='/usr/lib32/pkgconfig:/usr/lib/pkgconfig'

	patch -p1 -d $aname-$version/giscanner -i $SRC/use_python_header.diff
	patch -p1 -d $aname-$version -i $SRC/meson_python_header.diff
	patch -p1 -d $aname-$version -i $SRC/*.patch

	meson build $aname-$version \
		--libdir=/usr/lib32 \
		--prefix /usr \
		-D cairo=disabled \
		-D doctool=disabled \
		--cross-file $SRC/crossfile.ini

	ninja -C build -j ${JOBS:-1}
	DESTDIR=$PKG meson install -C build
}

